---
id: architecture
title: 전체 아키텍처 — 도메인 → Task → Skills
sidebar_label: 01. 전체 아키텍처
---

# 전체 아키텍처 — 도메인 → Task → Skills

RAP(Rapid Agentic Programming) 방식의 핵심은 **작업을 구조화**하는 것이다.
"AI한테 던지면 뭔가 나오겠지"가 아니라, 도메인을 명확히 나누고 각 레이어에서 최적의 도구를 사용한다.

---

## 1. 전체 구조 개요

```
전체 프로젝트
├── 도메인 A  →  Task A1, A2, A3
│                   └── Skills (프롬프트 템플릿)
├── 도메인 B  →  Task B1, B2
│                   └── Skills
└── 도메인 C  →  Task C1
                    └── Skills
```

**도메인**: 프로젝트에서 독립적으로 구분되는 기능 영역 (예: 인증, 결제, 알림)
**Task**: 도메인 내에서 실행 가능한 작업 단위
**Skills**: Task를 수행하기 위한 프롬프트 템플릿 + 컨텍스트

---

## 2. Task 분류와 모델 배분

Task를 아래 세 가지로 분류하면 어떤 모델을 쓸지 자연스럽게 결정된다.

| Task 유형 | 설명 | 적합한 접근 |
|-----------|------|-------------|
| **도메인 문해** | 설계, 아키텍처 결정, 복잡한 비즈니스 로직 | 고성능 모델 (Opus 4.6 등) |
| **반복 자동화** | Skills 기반 코드 생성, 테스트, 빌드 | 저렴한 경량 모델 |
| **비반복 build & test** | 새 기능 개발 + 검증 | 자동 모델 선정 + Skills 조합 |

### 실전 구분 기준

> "이 작업을 다음에 또 할 가능성이 있는가?"

- **예** → 반복 자동화 Task → Skills화 → 경량 모델로
- **아니오, 복잡한 판단 필요** → 도메인 문해 Task → 고성능 모델로
- **아니오, 새 기능** → 비반복 build & test → Auto 모드

---

## 3. Skills 설계 원칙

Skills는 단순한 프롬프트가 아니다. **저렴한 모델이 고품질 출력을 낼 수 있게 만드는 설계**가 핵심이다.

### Skills의 3요소

```
Skills
├── 컨텍스트 압축     — 모델이 알아야 할 도메인 지식 요약
├── 출력 형식 정의    — 예상 출력 구조 명시 (JSON, 코드 블록 등)
└── 제약 조건 명시    — 사용 기술 스택, 금지 패턴, 코딩 컨벤션
```

### Skills 문서 예시

```markdown
# Skills: FastAPI CRUD 생성

## 컨텍스트
- 프레임워크: FastAPI + SQLAlchemy 2.0 (async)
- 스키마: Pydantic v2 사용
- DB: PostgreSQL, Alembic 마이그레이션

## 출력 형식
- Router, Service, Schema, Model 레이어 분리
- 각 파일은 코드 블록으로 분리하여 제공

## 제약 조건
- 에러 핸들링: HTTPException + custom error schema
- 타입 힌트 100% 적용
- 테스트: pytest + httpx 비동기 패턴
```

---

## 4. 도메인 경계 설정 방법

세션을 전환하면 모델의 컨텍스트가 리셋된다. **도메인 경계를 잘 잡아두면 세션 복원이 빠르다.**

### 도메인 분리 기준

1. **독립 배포 가능한가?** — 분리 가능하면 별도 도메인
2. **다른 도메인에 영향 없이 수정 가능한가?** — 가능하면 좋은 경계
3. **하나의 세션에서 완결되는가?** — 세션 단위와 도메인 단위를 맞추면 효율적

### 도메인 컨텍스트 저장

도메인 설계가 끝나면 반드시 문서화하여 세션 전환 후에도 복원 가능하게 한다.

```bash
# 추천 저장 위치
.cursorrules              # Cursor 자동 로드
CLAUDE.md                 # Claude Code 자동 로드
skills/{domain}.md        # Opencode 수동 로드
```

:::tip 세션 전환 전 체크
새 세션을 열기 전에 현재 도메인의 주요 결정사항, 사용 기술, 미완성 Task를 해당 문서에 업데이트하라.
다음 세션 첫 프롬프트에 이 문서를 첨부하면 컨텍스트 복원에 드는 시간을 크게 줄일 수 있다.
:::

---

## 5. Skills화의 경제학

Skills를 만드는 데 처음에 시간이 들지만, 두 번째 실행부터는 이익이다.

```
Skills 미적용: 매번 고성능 모델 + 상세 지시 → 비용↑, 시간↑
Skills 적용:   경량 모델 + Skills 자동 로드   → 비용↓, 시간↓, 품질 일관
```

**Skills는 일종의 투자다.** 반복 빈도가 높은 작업일수록 먼저 Skills화하라.
